{% extends 'base.html' %}
{% load static %}

{% block title %}Discover Amazing Tours - Tours & Travels{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="tours-hero py-5 bg-dark text-white position-relative">
  <div class="background-overlay" style="background-image: url('{% static 'img/tours-hero-bg.jpg' %}');"></div>
  <div class="container position-relative py-6 z-index-1 text-center">
    <h1 class="display-4 fw-bold mb-4">Discover Your Next Adventure</h1>
    <p class="lead mb-5">Explore handcrafted tours designed by our travel experts to create unforgettable experiences</p>
    
    <!-- Search Form -->
    <div class="search-box mx-auto">
      <form method="get" class="row g-2">
        <div class="col-md-4">
          <div class="input-group">
            <span class="input-group-text bg-white"><i class="fas fa-search text-muted"></i></span>
            <input type="text" name="q" class="form-control form-control-lg" placeholder="Search tours..." value="{{ request.GET.q }}">
          </div>
        </div>
        <div class="col-md-3">
          <select name="destination" class="form-select form-select-lg" id="destination-filter">
            <option value="">All Destinations</option>
            <option value="europe">Europe</option>
            <option value="asia">Asia</option>
            <option value="africa">Africa</option>
            <option value="americas">Americas</option>
            <option value="oceania">Oceania</option>
          </select>
        </div>
        <div class="col-md-3">
          <select name="category" class="form-select form-select-lg" id="category-filter">
            <option value="">All Categories</option>
            <option value="cultural">Cultural</option>
            <option value="adventure">Adventure</option>
            <option value="luxury">Luxury</option>
            <option value="family">Family</option>
            <option value="honeymoon">Honeymoon</option>
          </select>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-primary btn-lg w-100">
            <i class="fas fa-search me-2"></i> Search
          </button>
        </div>
      </form>
    </div>
  </div>
</section>

<!-- Tours Section -->
<section class="py-6">
  <div class="container">
    <div class="row mb-5">
      <div class="col-md-6">
        <h2 class="display-5 fw-bold mb-0">Featured Tours</h2>
      </div>
      <div class="col-md-6 text-md-end">
        <div class="d-inline-block me-3">
          <span class="me-2">Sort by:</span>
          <select class="form-select d-inline-block w-auto" id="sort-filter">
            <option value="featured">Featured</option>
            <option value="price_asc">Price: Low to High</option>
            <option value="price_desc">Price: High to Low</option>
            <option value="duration_asc">Duration: Short to Long</option>
            <option value="duration_desc">Duration: Long to Short</option>
            <option value="rating">Top Rated</option>
          </select>
        </div>
        <div class="btn-group" role="group">
          <button class="btn btn-outline-secondary view-toggle" data-view="list">
            <i class="fas fa-list"></i>
          </button>
          <button class="btn btn-outline-secondary active view-toggle" data-view="grid">
            <i class="fas fa-th-large"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Tours will be loaded here by JavaScript -->
    <div id="tours-container" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
      <!-- Tours will be dynamically inserted here -->
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="col-12" style="display: none;">
      <div class="alert alert-info text-center py-5">
        <h4 class="mb-3">No tours found matching your criteria</h4>
        <p class="mb-0">Try adjusting your search filters or <a href="#" class="alert-link">view all tours</a></p>
      </div>
    </div>

    <!-- Pagination -->
    <nav aria-label="Tour pagination" class="mt-5">
      <ul class="pagination justify-content-center" id="pagination">
        <!-- Pagination will be dynamically inserted here -->
      </ul>
    </nav>
  </div>
</section>

<!-- Categories Section -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="text-center mb-5">Browse By Category</h2>
    <div class="row g-4">
      <div class="col-6 col-md-4 col-lg-2">
        <a href="#" class="card category-card text-decoration-none text-center border-0 bg-white hover-lift" data-category="cultural">
          <div class="card-body p-3">
            <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
              <i class="fas fa-landmark fa-lg"></i>
            </div>
            <h6 class="mb-0">Cultural</h6>
          </div>
        </a>
      </div>
      <div class="col-6 col-md-4 col-lg-2">
        <a href="#" class="card category-card text-decoration-none text-center border-0 bg-white hover-lift" data-category="adventure">
          <div class="card-body p-3">
            <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
              <i class="fas fa-mountain fa-lg"></i>
            </div>
            <h6 class="mb-0">Adventure</h6>
          </div>
        </a>
      </div>
      <div class="col-6 col-md-4 col-lg-2">
        <a href="#" class="card category-card text-decoration-none text-center border-0 bg-white hover-lift" data-category="luxury">
          <div class="card-body p-3">
            <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
              <i class="fas fa-crown fa-lg"></i>
            </div>
            <h6 class="mb-0">Luxury</h6>
          </div>
        </a>
      </div>
      <div class="col-6 col-md-4 col-lg-2">
        <a href="#" class="card category-card text-decoration-none text-center border-0 bg-white hover-lift" data-category="family">
          <div class="card-body p-3">
            <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
              <i class="fas fa-users fa-lg"></i>
            </div>
            <h6 class="mb-0">Family</h6>
          </div>
        </a>
      </div>
      <div class="col-6 col-md-4 col-lg-2">
        <a href="#" class="card category-card text-decoration-none text-center border-0 bg-white hover-lift" data-category="honeymoon">
          <div class="card-body p-3">
            <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
              <i class="fas fa-ring fa-lg"></i>
            </div>
            <h6 class="mb-0">Honeymoon</h6>
          </div>
        </a>
      </div>
      <div class="col-6 col-md-4 col-lg-2">
        <a href="#" class="card category-card text-decoration-none text-center border-0 bg-white hover-lift" data-category="beach">
          <div class="card-body p-3">
            <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
              <i class="fas fa-umbrella-beach fa-lg"></i>
            </div>
            <h6 class="mb-0">Beach</h6>
          </div>
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Testimonials Section -->
<section class="py-6">
  <div class="container">
    <div class="row justify-content-center mb-5">
      <div class="col-lg-8 text-center">
        <h2 class="display-5 fw-bold mb-3">What Our Travelers Say</h2>
        <p class="lead">Hear from people who've experienced our tours firsthand</p>
      </div>
    </div>
    
    <div class="row g-4">
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body p-4">
            <div class="d-flex mb-3">
              <div class="me-3">
                <img src="{% static 'img/testimonial-1.jpg' %}" class="rounded-circle" width="50" alt="Sarah Johnson">
              </div>
              <div>
                <h5 class="mb-0">Sarah Johnson</h5>
                <div class="text-warning small">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                </div>
              </div>
            </div>
            <p class="mb-0">"The Italian countryside tour exceeded all expectations. Every detail was perfectly planned, and our guide's knowledge made the experience truly special."</p>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body p-4">
            <div class="d-flex mb-3">
              <div class="me-3">
                <img src="{% static 'img/testimonial-2.jpg' %}" class="rounded-circle" width="50" alt="Michael Chen">
              </div>
              <div>
                <h5 class="mb-0">Michael Chen</h5>
                <div class="text-warning small">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                </div>
              </div>
            </div>
            <p class="mb-0">"The Southeast Asia adventure was the trip of a lifetime. The local experiences we had were authentic and unforgettable. Will definitely book again!"</p>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body p-4">
            <div class="d-flex mb-3">
              <div class="me-3">
                <img src="{% static 'img/testimonial-3.jpg' %}" class="rounded-circle" width="50" alt="Emma Rodriguez">
              </div>
              <div>
                <h5 class="mb-0">Emma Rodriguez</h5>
                <div class="text-warning small">
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star"></i>
                  <i class="fas fa-star-half-alt"></i>
                </div>
              </div>
            </div>
            <p class="mb-0">"The customer service was exceptional throughout our African safari. They handled all the logistics so we could just enjoy the experience. Highly recommend!"</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="py-6 bg-primary text-white">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-8">
        <h2 class="display-5 fw-bold mb-3">Need Help Choosing Your Perfect Tour?</h2>
        <p class="lead mb-lg-0">Our travel experts are ready to help you find the ideal experience for your interests and budget.</p>
      </div>
      <div class="col-lg-4 text-lg-end mt-4 mt-lg-0">
        <a href="#" class="btn btn-light btn-lg px-4 me-2">
          <i class="fas fa-headset me-2"></i> Contact Us
        </a>
        <a href="#" class="btn btn-outline-light btn-lg px-4">
          <i class="fas fa-question-circle me-2"></i> FAQ
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Sample Tour Data (would normally come from backend) -->
<script id="tours-data" type="application/json">
{
  "tours": [
    {
      "id": 1,
      "name": "Italian Adventure",
      "description": "Experience the art, history, and cuisine of Italy's most iconic cities on this 10-day cultural journey.",
      "price": 2499,
      "duration_days": 10,
      "category": "cultural",
      "destination": "europe",
      "image": "{% static 'img/tour-italy.jpg' %}",
      "rating": 4.5,
      "review_count": 24,
      "is_featured": true,
      "available": true,
      "locations": ["Rome", "Florence", "Venice"]
    },
    {
      "id": 2,
      "name": "Japanese Cultural Tour",
      "description": "Immerse yourself in Japan's rich traditions from ancient temples to modern cities on this 12-day exploration.",
      "price": 3199,
      "duration_days": 12,
      "category": "cultural",
      "destination": "asia",
      "image": "{% static 'img/tour-japan.jpg' %}",
      "rating": 5,
      "review_count": 32,
      "is_featured": false,
      "available": true,
      "locations": ["Tokyo", "Kyoto", "Osaka"]
    },
    {
      "id": 3,
      "name": "Bali Retreat",
      "description": "Relax and rejuvenate with this 8-day luxury retreat featuring private villas, spa treatments, and cultural experiences.",
      "price": 1899,
      "duration_days": 8,
      "category": "luxury",
      "destination": "asia",
      "image": "{% static 'img/tour-bali.jpg' %}",
      "rating": 4,
      "review_count": 18,
      "is_featured": false,
      "available": true,
      "locations": ["Ubud", "Seminyak", "Nusa Penida"]
    },
    {
      "id": 4,
      "name": "Peru Expedition",
      "description": "Trek through the Andes and explore ancient Incan ruins on this 14-day adventure tour.",
      "price": 2799,
      "duration_days": 14,
      "category": "adventure",
      "destination": "americas",
      "image": "{% static 'img/tour-peru.jpg' %}",
      "rating": 5,
      "review_count": 27,
      "is_featured": true,
      "available": true,
      "locations": ["Lima", "Cusco", "Machu Picchu"]
    },
    {
      "id": 5,
      "name": "African Safari",
      "description": "Experience the thrill of spotting the Big Five on this 7-day luxury safari with expert guides.",
      "price": 3499,
      "duration_days": 7,
      "category": "adventure",
      "destination": "africa",
      "image": "{% static 'img/tour-safari.jpg' %}",
      "rating": 4.5,
      "review_count": 21,
      "is_featured": false,
      "available": true,
      "locations": ["Kruger National Park"]
    },
    {
      "id": 6,
      "name": "French Riviera Escape",
      "description": "Indulge in the glamour of the Côte d'Azur with this 9-day luxury tour featuring gourmet dining and private yacht excursions.",
      "price": 4299,
      "duration_days": 9,
      "category": "luxury",
      "destination": "europe",
      "image": "{% static 'img/tour-france.jpg' %}",
      "rating": 4,
      "review_count": 15,
      "is_featured": false,
      "available": true,
      "locations": ["Nice", "Cannes", "Monaco"]
    },
    {
      "id": 7,
      "name": "Australian Outback Adventure",
      "description": "Explore the rugged beauty of the Australian Outback on this 10-day adventure tour.",
      "price": 2899,
      "duration_days": 10,
      "category": "adventure",
      "destination": "oceania",
      "image": "{% static 'img/tour-australia.jpg' %}",
      "rating": 4.5,
      "review_count": 19,
      "is_featured": false,
      "available": true,
      "locations": ["Uluru", "Alice Springs", "Kings Canyon"]
    },
    {
      "id": 8,
      "name": "Greek Island Hopping",
      "description": "Discover the beauty of the Greek islands on this 12-day cultural and beach tour.",
      "price": 2399,
      "duration_days": 12,
      "category": "beach",
      "destination": "europe",
      "image": "{% static 'img/tour-greece.jpg' %}",
      "rating": 4.5,
      "review_count": 28,
      "is_featured": true,
      "available": true,
      "locations": ["Santorini", "Mykonos", "Crete"]
    }
  ]
}
</script>
{% endblock %}

{% block extra_css %}
<style>
  /* Hero Section */
  .tours-hero {
    padding: 100px 0;
    background-color: #333;
    color: white;
  }
  
  .background-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    opacity: 0.5;
    z-index: 0;
  }
  
  .search-box {
    max-width: 900px;
    background: rgba(255,255,255,0.9);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }
  
  /* Tour Cards */
  .tour-card-grid {
    transition: all 0.3s ease;
    border: none;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
  }
  
  .tour-card-grid:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  }
  
  .tour-card-grid .card-img-top {
    height: 200px;
    object-fit: cover;
  }
  
  .tour-card-list {
    transition: all 0.3s ease;
    border: none;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
  }
  
  .tour-card-list:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
  }
  
  /* Category Cards */
  .category-card {
    transition: all 0.3s ease;
  }
  
  .category-card:hover {
    background-color: #f8f9fa;
  }
  
  .icon-circle {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Hover Effects */
  .hover-lift {
    transition: all 0.3s ease;
  }
  
  .hover-lift:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  }
  
  /* List View Styles */
  .list-view .col {
    flex: 0 0 100%;
    max-width: 100%;
  }
  
  .list-view .tour-card-grid {
    flex-direction: row;
  }
  
  .list-view .tour-card-grid .card-img-top {
    width: 300px;
    height: 100%;
    border-radius: 0.375rem 0 0 0.375rem;
  }
  
  /* Active Filter */
  .category-card.active {
    background-color: #e9f5ff;
    border: 1px solid #0d6efd;
  }
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Get tour data from JSON
  const toursData = JSON.parse(document.getElementById('tours-data').textContent);
  let tours = toursData.tours;
  let currentView = 'grid';
  let currentPage = 1;
  const toursPerPage = 6;
  
  // DOM elements
  const toursContainer = document.getElementById('tours-container');
  const emptyState = document.getElementById('empty-state');
  const pagination = document.getElementById('pagination');
  const categoryFilter = document.getElementById('category-filter');
  const destinationFilter = document.getElementById('destination-filter');
  const sortFilter = document.getElementById('sort-filter');
  const viewToggles = document.querySelectorAll('.view-toggle');
  const categoryCards = document.querySelectorAll('.category-card');
  
  // Initial render
  renderTours(tours);
  renderPagination(tours.length);
  
  // View toggle functionality
  viewToggles.forEach(toggle => {
    toggle.addEventListener('click', function() {
      viewToggles.forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      currentView = this.dataset.view;
      
      if (currentView === 'list') {
        toursContainer.classList.add('list-view');
      } else {
        toursContainer.classList.remove('list-view');
      }
      
      renderTours(tours);
    });
  });
  
  // Category card filtering
  categoryCards.forEach(card => {
    card.addEventListener('click', function(e) {
      e.preventDefault();
      categoryCards.forEach(c => c.classList.remove('active'));
      this.classList.add('active');
      categoryFilter.value = this.dataset.category;
      filterTours();
    });
  });
  
  // Filter functionality
  function filterTours() {
    const category = categoryFilter.value;
    const destination = destinationFilter.value;
    const sort = sortFilter.value;
    
    let filteredTours = [...toursData.tours];
    
    // Filter by category
    if (category) {
      filteredTours = filteredTours.filter(tour => tour.category === category);
    }
    
    // Filter by destination
    if (destination) {
      filteredTours = filteredTours.filter(tour => tour.destination === destination);
    }
    
    // Sort tours
    switch(sort) {
      case 'price_asc':
        filteredTours.sort((a, b) => a.price - b.price);
        break;
      case 'price_desc':
        filteredTours.sort((a, b) => b.price - a.price);
        break;
      case 'duration_asc':
        filteredTours.sort((a, b) => a.duration_days - b.duration_days);
        break;
      case 'duration_desc':
        filteredTours.sort((a, b) => b.duration_days - a.duration_days);
        break;
      case 'rating':
        filteredTours.sort((a, b) => b.rating - a.rating);
        break;
      case 'featured':
      default:
        filteredTours.sort((a, b) => b.is_featured - a.is_featured);
    }
    
    tours = filteredTours;
    currentPage = 1;
    renderTours(tours);
    renderPagination(tours.length);
  }
  
  // Add event listeners for filters
  categoryFilter.addEventListener('change', filterTours);
  destinationFilter.addEventListener('change', filterTours);
  sortFilter.addEventListener('change', filterTours);
  
  // Render tours
  function renderTours(toursToRender) {
    toursContainer.innerHTML = '';
    
    if (toursToRender.length === 0) {
      emptyState.style.display = 'block';
      return;
    }
    
    emptyState.style.display = 'none';
    
    // Get tours for current page
    const startIndex = (currentPage - 1) * toursPerPage;
    const endIndex = startIndex + toursPerPage;
    const paginatedTours = toursToRender.slice(startIndex, endIndex);
    
    paginatedTours.forEach(tour => {
      const tourCard = createTourCard(tour);
      toursContainer.appendChild(tourCard);
    });
  }
  
  // Create a tour card
  function createTourCard(tour) {
    const col = document.createElement('div');
    col.className = currentView === 'list' ? 'col list-view-item' : 'col';
    
    const card = document.createElement('div');
    card.className = currentView === 'list' ? 'card h-100 tour-card-list' : 'card h-100 tour-card-grid';
    
    // Card image
    let cardImage;
    if (currentView === 'list') {
      const row = document.createElement('div');
      row.className = 'row g-0 h-100';
      
      const imgCol = document.createElement('div');
      imgCol.className = 'col-md-4';
      
      cardImage = document.createElement('img');
      cardImage.src = tour.image;
      cardImage.className = 'img-fluid rounded-start h-100';
      cardImage.style.objectFit = 'cover';
      cardImage.alt = tour.name;
      
      imgCol.appendChild(cardImage);
      row.appendChild(imgCol);
      
      const contentCol = document.createElement('div');
      contentCol.className = 'col-md-8';
      
      const cardBody = createCardBody(tour, true);
      contentCol.appendChild(cardBody);
      row.appendChild(contentCol);
      
      card.appendChild(row);
    } else {
      cardImage = document.createElement('img');
      cardImage.src = tour.image;
      cardImage.className = 'card-img-top';
      cardImage.alt = tour.name;
      card.appendChild(cardImage);
      
      // Card badges
      const cardBadges = document.createElement('div');
      cardBadges.className = 'card-img-overlay d-flex justify-content-between align-items-start p-3';
      
      if (tour.is_featured) {
        const featuredBadge = document.createElement('span');
        featuredBadge.className = 'badge bg-warning text-dark';
        featuredBadge.textContent = 'Featured';
        cardBadges.appendChild(featuredBadge);
      }
      
      const availableBadge = document.createElement('span');
      availableBadge.className = 'badge bg-success';
      availableBadge.textContent = 'Available';
      cardBadges.appendChild(availableBadge);
      
      card.appendChild(cardBadges);
      
      const cardBody = createCardBody(tour, false);
      card.appendChild(cardBody);
    }
    
    col.appendChild(card);
    return col;
  }
  
  // Create card body
  function createCardBody(tour, isListView) {
    const cardBody = document.createElement('div');
    cardBody.className = isListView ? 'card-body h-100 d-flex flex-column' : 'card-body';
    
    // Category and rating
    const metaDiv = document.createElement('div');
    metaDiv.className = 'd-flex justify-content-between mb-2';
    
    const categoryBadge = document.createElement('span');
    categoryBadge.className = 'badge bg-primary';
    categoryBadge.textContent = tour.category.charAt(0).toUpperCase() + tour.category.slice(1);
    metaDiv.appendChild(categoryBadge);
    
    const ratingDiv = document.createElement('div');
    ratingDiv.className = 'text-warning';
    
    // Add stars
    for (let i = 1; i <= 5; i++) {
      const star = document.createElement('i');
      star.className = i <= tour.rating ? 'fas fa-star' : 
                       (i - 0.5 <= tour.rating ? 'fas fa-star-half-alt' : 'far fa-star');
      ratingDiv.appendChild(star);
    }
    
    const reviewCount = document.createElement('span');
    reviewCount.className = 'text-muted ms-1 small';
    reviewCount.textContent = `(${tour.review_count})`;
    ratingDiv.appendChild(reviewCount);
    
    metaDiv.appendChild(ratingDiv);
    cardBody.appendChild(metaDiv);
    
    // Title
    const title = document.createElement(isListView ? 'h3' : 'h3');
    title.className = isListView ? 'card-title mb-2' : 'card-title h5 mb-3';
    title.textContent = tour.name;
    cardBody.appendChild(title);
    
    // Location
    const location = document.createElement('p');
    location.className = 'card-text text-muted mb-3';
    
    const locationIcon = document.createElement('i');
    locationIcon.className = 'fas fa-map-marker-alt me-1';
    location.appendChild(locationIcon);
    
    location.appendChild(document.createTextNode(tour.locations.join(', ')));
    cardBody.appendChild(location);
    
    // Description
    const description = document.createElement('p');
    description.className = isListView ? 'card-text flex-grow-1' : 'card-text mb-4';
    description.textContent = tour.description;
    cardBody.appendChild(description);
    
    // Price and duration
    const priceDurationDiv = document.createElement('div');
    priceDurationDiv.className = 'd-flex justify-content-between align-items-center';
    
    if (isListView) {
      priceDurationDiv.classList.add('border-top', 'pt-3');
    } else {
      priceDurationDiv.classList.add('border-top', 'pt-3');
    }
    
    const priceDiv = document.createElement('div');
    const price = document.createElement('span');
    price.className = 'text-primary fw-bold';
    price.textContent = `$${tour.price}`;
    priceDiv.appendChild(price);
    
    const perPerson = document.createElement('span');
    perPerson.className = 'text-muted small';
    perPerson.textContent = '/person';
    priceDiv.appendChild(perPerson);
    
    priceDurationDiv.appendChild(priceDiv);
    
    const durationDiv = document.createElement('div');
    const duration = document.createElement('span');
    duration.className = 'text-muted small';
    
    const durationIcon = document.createElement('i');
    durationIcon.className = 'fas fa-clock me-1';
    duration.appendChild(durationIcon);
    
    duration.appendChild(document.createTextNode(`${tour.duration_days} days`));
    durationDiv.appendChild(duration);
    
    priceDurationDiv.appendChild(durationDiv);
    cardBody.appendChild(priceDurationDiv);
    
    // View details button - CHANGED TO LINK TO PAYMENTS PAGE
    if (isListView) {
      const detailsDiv = document.createElement('div');
      detailsDiv.className = 'mt-3';
      
      const detailsButton = document.createElement('a');
      detailsButton.href = `/bookings/tour-payment/?tour_id=${tour.id}`;
      detailsButton.className = 'btn btn-primary active';
      detailsButton.innerHTML = 'View Details <i class="fas fa-arrow-right ms-2"></i>';
      detailsButton.onclick = function(e) {
        e.preventDefault();
        window.location.href = `/bookings/tour-payment/?tour_id=${tour.id}`;
      };
      detailsDiv.appendChild(detailsButton);
      
      cardBody.appendChild(detailsDiv);
    } else {
      const cardFooter = document.createElement('div');
      cardFooter.className = 'card-footer bg-white border-0 pt-0 pb-3';
      
      const detailsButton = document.createElement('a');
      detailsButton.href = `/bookings/tour-payment/?tour_id=${tour.id}`;
      detailsButton.className = 'btn btn-primary w-100 active';
      detailsButton.innerHTML = '<i class="fas fa-eye me-2"></i> View Tour';
      detailsButton.onclick = function(e) {
        e.preventDefault();
        window.location.href = `/bookings/tour-payment/?tour_id=${tour.id}`;
      };
      cardFooter.appendChild(detailsButton);
      
      cardBody.appendChild(cardFooter);
    }
    
    return cardBody;
  }
  
  // Render pagination
  function renderPagination(totalTours) {
    pagination.innerHTML = '';
    
    const totalPages = Math.ceil(totalTours / toursPerPage);
    
    if (totalPages <= 1) return;
    
    // Previous button
    const prevLi = document.createElement('li');
    prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
    
    const prevLink = document.createElement('a');
    prevLink.className = 'page-link';
    prevLink.href = '#';
    prevLink.setAttribute('aria-label', 'Previous');
    prevLink.innerHTML = '<span aria-hidden="true">&laquo;</span>';
    
    prevLink.addEventListener('click', function(e) {
      e.preventDefault();
      if (currentPage > 1) {
        currentPage--;
        renderTours(tours);
        updatePagination();
      }
    });
    
    prevLi.appendChild(prevLink);
    pagination.appendChild(prevLi);
    
    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
      const pageLi = document.createElement('li');
      pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
      
      const pageLink = document.createElement('a');
      pageLink.className = 'page-link';
      pageLink.href = '#';
      pageLink.textContent = i;
      
      pageLink.addEventListener('click', function(e) {
        e.preventDefault();
        currentPage = i;
        renderTours(tours);
        updatePagination();
      });
      
      pageLi.appendChild(pageLink);
      pagination.appendChild(pageLi);
    }
    
    // Next button
    const nextLi = document.createElement('li');
    nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
    
    const nextLink = document.createElement('a');
    nextLink.className = 'page-link';
    nextLink.href = '#';
    nextLink.setAttribute('aria-label', 'Next');
    nextLink.innerHTML = '<span aria-hidden="true">&raquo;</span>';
    
    nextLink.addEventListener('click', function(e) {
      e.preventDefault();
      if (currentPage < totalPages) {
        currentPage++;
        renderTours(tours);
        updatePagination();
      }
    });
    
    nextLi.appendChild(nextLink);
    pagination.appendChild(nextLi);
  }
  
  // Update pagination active state
  function updatePagination() {
    const pageItems = pagination.querySelectorAll('.page-item');
    pageItems.forEach((item, index) => {
      if (index === 0) {
        // Previous button
        item.classList.toggle('disabled', currentPage === 1);
      } else if (index === pageItems.length - 1) {
        // Next button
        item.classList.toggle('disabled', currentPage === pageItems.length - 2);
      } else {
        // Page numbers
        const pageNum = index;
        item.classList.toggle('active', pageNum === currentPage);
      }
    });
  }
});
</script>
{% endblock %}